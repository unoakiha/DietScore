<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é£Ÿäº‹è¨˜éŒ²ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç”¨ï¼‰</title>
  <style>
    :root{
      /* === æŒ‡å®šè‰² === */
      --bg:#FFBE55;      /* èƒŒæ™¯ */
      --card:#FFD99B;    /* å‰é¢ã‚«ãƒ¼ãƒ‰ */
      --input:#FFF5E7;   /* å…¥åŠ›æ¬„ãƒ»è¡¨ç¤ºæ¬„ */

      /* === è£œåŠ©è‰² === */
      --muted: rgba(74, 59, 42, .75);
      --text:#4a3b2a;
      --line: rgba(74, 59, 42, .25);
      --accent:#f97316; /* orange */
      --accent2:#22c55e;
      --danger:#ef4444;
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", "Segoe UI", Arial, sans-serif;
      background: var(--bg);
      color:var(--text);
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: clamp(14px, 3.5vw, 20px) 16px 48px;
    }

    header{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 16px;
    }

    h1{
      margin:0;
      font-size: clamp(18px, 2.6vw, 20px);
      letter-spacing: .02em;
      line-height: 1.25;
    }

    .hint{
      margin:0;
      color:var(--muted);
      font-size: 12px;
      line-height: 1.4;
    }

    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: 16px;
      padding: clamp(12px, 2.8vw, 16px);
      box-shadow: 0 14px 40px rgba(0,0,0,.18);
    }

    .grid{
      display:grid;
      gap:12px;
    }

    /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1åˆ—ï¼ˆã‚¹ãƒãƒ›ï¼‰ */
    .grid.cols2{ grid-template-columns: 1fr; }
    .grid.cols3{ grid-template-columns: 1fr; }

    /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆä»¥ä¸Šã§2åˆ—/3åˆ— */
    @media (min-width: 720px){
      .grid.cols2{ grid-template-columns: 1fr 1fr; }
      .grid.cols3{ grid-template-columns: 2fr 1fr 1fr; }
    }

    label{
      display:block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    input, textarea, select{
      width:100%;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--line);
      background: var(--input);
      color: var(--text);
      outline: none;
      font-size: 14px;
    }

    input:focus, textarea:focus{
      border-color: rgba(249,115,22,.75);
      box-shadow: 0 0 0 3px rgba(249,115,22,.18);
    }

    textarea{
      min-height: 170px;
      resize: vertical;
      line-height: 1.55;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Noto Sans Mono", monospace;
      font-size: 13px;
    }

    .row{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap: wrap;
    }

    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(255,245,231,.65);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform .02s ease, background .12s ease, border-color .12s ease;
      font-weight: 600;
      font-size: 13px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      white-space: nowrap;
    }

    .btn:hover{
      border-color: rgba(249,115,22,.55);
      transform: translateY(-1px);
      background: rgba(255,245,231,.9);
    }

    .btn.primary{
      background: rgba(249,115,22,.18);
      border-color: rgba(249,115,22,.55);
    }
    .btn.primary:hover{
      background: rgba(249,115,22,.24);
    }

    .btn.good{
      background: rgba(34,197,94,.14);
      border-color: rgba(34,197,94,.45);
    }
    .btn.good:hover{ background: rgba(34,197,94,.20); }

    .btn.danger{
      background: rgba(239,68,68,.12);
      border-color: rgba(239,68,68,.45);
    }
    .btn.danger:hover{ background: rgba(239,68,68,.18); }

    .btn.small{
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 12px;
    }

    .divider{
      height:1px;
      background: var(--line);
      margin: 14px 0;
    }

    .item{
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 14px;
      background: rgba(255,245,231,.35);
    }

    .itemHead{
      display:flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .itemTitle{
      margin:0;
      font-size: 14px;
      letter-spacing: .02em;
      line-height: 1.3;
    }

    .muted{
      color: var(--muted);
      font-size: 12px;
    }

    .nutrients{
      display:flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }

    .nutRow{
      display:grid;
      grid-template-columns: 1.2fr .8fr .6fr auto;
      gap:10px;
      align-items:end;
    }

    @media (max-width: 520px){
      .nutRow{ grid-template-columns: 1fr 1fr; }
      .nutRow .nutRemove{ justify-self: start; }
    }

    .note{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.5;
      margin-top: 10px;
    }

    .toast{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
      min-height: 18px;
    }

    .topActions{
      display:flex;
      flex-wrap: wrap;
      gap:10px;
      justify-content:flex-end;
    }

    /* ===== ã“ã“ã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¼·åŒ–ï¼ˆã‚¹ãƒãƒ›ç‰¹åŒ–ï¼‰ ===== */
    @media (max-width: 480px){
      header{
        flex-direction: column;
        align-items: stretch;
      }
      .topActions{
        justify-content: stretch;
      }
      .topActions .btn{
        width: 100%;
      }

      /* è¡Œã®å³å´ãƒœã‚¿ãƒ³ãŒè©°ã¾ã‚‹ã®ã‚’é˜²ã */
      .row{
        align-items: stretch;
      }
      .row .btn{
        flex: 1 1 auto;
      }

      /* å“ç›®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚‚ç¸¦ç©ã¿ã« */
      .itemHead{
        flex-direction: column;
        align-items: stretch;
      }
      .itemHead .btn{
        width: 100%;
      }

      /* ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚’å°‘ã—è¦‹ã‚„ã™ã */
      textarea{
        min-height: 200px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>é£Ÿäº‹è¨˜éŒ²ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆã‚³ãƒ”ãƒšç”¨ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆï¼‰</h1>
        <p class="hint">å“åã¨ä¸»è¦æ „é¤Šç´ ã‚’å…¥åŠ› â†’ ã€Œè¨˜éŒ²ç”¨ã«è¡¨ç¤ºã€ã§ã€ã‚ãªãŸã®æå‡ºå½¢å¼ï¼ˆâ—åŒºåˆ‡ã‚Šãƒ»æ”¹è¡Œï¼‰ã«æ•´å½¢ã—ã¦å‡ºåŠ›ã—ã¾ã™ã€‚</p>
      </div>
      <div class="topActions">
        <button class="btn" id="btnFillNow" type="button">ğŸ•’ ä»Šã®æ—¥æ™‚ã‚’å…¥ã‚Œã‚‹</button>
        <button class="btn danger" id="btnReset" type="button">ğŸ—‘ å…¨æ¶ˆå»</button>
      </div>
    </header>

    <div class="card grid" style="gap:16px;">
      <!-- â‘  æ—¥ä»˜ãƒ»æ™‚é–“ -->
      <section>
        <div class="grid cols2">
          <div>
            <label for="dt">â‘  é£Ÿäº‹ã®æ—¥ä»˜ã¨æ™‚é–“</label>
            <input id="dt" type="datetime-local" />
          </div>
          <div>
            <label for="dtLabel">ï¼ˆä»»æ„ï¼‰è¦‹å‡ºã—ã«ä½¿ã†æ–‡è¨€</label>
            <input id="dtLabel" type="text" placeholder="ä¾‹ï¼š2026/1/11 æœé£Ÿ / ä¼‘æ†©ä¸­ ãªã©" />
          </div>
        </div>
        <div class="note">
          å‡ºåŠ›ãƒ†ã‚­ã‚¹ãƒˆã®å…ˆé ­ã«ã€Œæ—¥ä»˜ãƒ»æ™‚é–“ã€ã‚’ä»˜ã‘ãŸã„å ´åˆã¯ã€<span class="muted">å³ã®ä»»æ„æ¬„</span>ã«å¥½ããªè¦‹å‡ºã—ã‚‚æ›¸ã‘ã¾ã™ï¼ˆç©ºãªã‚‰æ—¥æ™‚ã ã‘è¡¨ç¤ºï¼‰ã€‚
        </div>
      </section>

      <div class="divider"></div>

      <!-- â‘¡ å“ç›® -->
      <section>
        <div class="row" style="justify-content:space-between;">
          <div>
            <div class="muted">â‘¡ å“åãƒ»ä¸»è¦æ „é¤Šä¾¡</div>
          </div>
          <div class="row">
            <button class="btn primary" id="btnAddItem" type="button">ï¼‹ å“ç›®ã‚’è¿½åŠ </button>
          </div>
        </div>

        <div id="items" class="grid" style="margin-top:12px; gap:12px;"></div>

        <div class="note">
          ä¸»è¦æ „é¤Šç´ ã¯å›ºå®šï¼ˆç†±é‡/ãŸã‚“ã±ãè³ª/è„‚è³ª/ç‚­æ°´åŒ–ç‰©/é£Ÿå¡©ç›¸å½“é‡ï¼‰ã€‚<br/>
          ç³–è³ªãƒ»é£Ÿç‰©ç¹Šç¶­ã¯ä»»æ„ã€‚ãƒŸãƒãƒ©ãƒ«/ãƒ“ã‚¿ãƒŸãƒ³ãªã©ã¯ â‘¢ ã®ã€Œï¼‹è¿½åŠ æ „é¤Šç´ ã€ã§è‡ªç”±ã«è¿½åŠ ã§ãã¾ã™ã€‚
        </div>
      </section>

      <div class="divider"></div>

      <!-- å‡ºåŠ› -->
      <section>
        <div class="row" style="justify-content:space-between;">
          <div class="muted">å‡ºåŠ›</div>
          <div class="row">
            <button class="btn good" id="btnGenerate" type="button">ğŸ“„ è¨˜éŒ²ç”¨ã«è¡¨ç¤º</button>
            <button class="btn" id="btnCopy" type="button">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
          </div>
        </div>

        <div style="margin-top:10px;">
          <label for="out">ã‚³ãƒ”ãƒšç”¨ãƒ†ã‚­ã‚¹ãƒˆ</label>
          <textarea id="out" placeholder="ã“ã“ã«æ•´å½¢çµæœãŒå‡ºã¾ã™"></textarea>
        </div>
        <div class="toast" id="toast"></div>
      </section>
    </div>
  </div>

  <template id="tplItem">
    <div class="item" data-item>
      <div class="itemHead">
        <h2 class="itemTitle">å“ç›® <span data-item-index></span></h2>
        <button class="btn danger small" type="button" data-remove-item>å‰Šé™¤</button>
      </div>

      <div class="grid cols2">
        <div>
          <label>å“å</label>
          <input type="text" data-name placeholder="ä¾‹ï¼šã‚µãƒˆã‚¦ã®ã”ã¯ã‚“" />
        </div>
        <div>
          <label>ï¼ˆä»»æ„ï¼‰è£œè¶³</label>
          <input type="text" data-note placeholder="ä¾‹ï¼š(1é£Ÿ200gã‚ãŸã‚Š) / â€¦ 30g / â€¦ 1å€‹ ãªã©" />
        </div>
      </div>

      <div class="grid cols3" style="margin-top:10px;">
        <div>
          <label>ç†±é‡ (kcal)</label>
          <input type="number" step="0.1" min="0" data-kcal placeholder="ä¾‹ï¼š276" />
        </div>
        <div>
          <label>ãŸã‚“ã±ãè³ª (g)</label>
          <input type="number" step="0.1" min="0" data-protein placeholder="ä¾‹ï¼š4.6" />
        </div>
        <div>
          <label>è„‚è³ª (g)</label>
          <input type="number" step="0.1" min="0" data-fat placeholder="ä¾‹ï¼š0" />
        </div>
      </div>

      <div class="grid cols3" style="margin-top:10px;">
        <div>
          <label>ç‚­æ°´åŒ–ç‰© (g)</label>
          <input type="number" step="0.1" min="0" data-carb placeholder="ä¾‹ï¼š63.8" />
        </div>
        <div>
          <label>ï¼ˆä»»æ„ï¼‰ç³–è³ª (g)</label>
          <input type="text" data-sugar placeholder="ä¾‹ï¼š8.2 / 0-1.3 ãªã©ç¯„å›²ã‚‚å¯" />
        </div>
        <div>
          <label>ï¼ˆä»»æ„ï¼‰é£Ÿç‰©ç¹Šç¶­ (g)</label>
          <input type="text" data-fiber placeholder="ä¾‹ï¼š0.4 / 0-1.3 ãªã©ç¯„å›²ã‚‚å¯" />
        </div>
      </div>

      <div class="grid cols2" style="margin-top:10px;">
        <div>
          <label>é£Ÿå¡©ç›¸å½“é‡ (g)</label>
          <input type="number" step="0.01" min="0" data-salt placeholder="ä¾‹ï¼š1.5" />
        </div>
        <div>
          <label>ï¼ˆä»»æ„ï¼‰ã“ã®å“ç›®ã¯ã€Œé‡ã ã‘ã€ã§ã‚‚OK</label>
          <input type="text" data-amountOnly placeholder="ä¾‹ï¼šã‚­ãƒ ãƒ â€¦ 30g / ã¿ã‹ã‚“ â€¦ 1å€‹ ãªã©" />
        </div>
      </div>

      <div class="divider"></div>

      <!-- â‘¢ è¿½åŠ æ „é¤Šç´  -->
      <div class="row" style="justify-content:space-between;">
        <div class="muted">â‘¢ è¿½åŠ è¨˜éŒ²ï¼ˆãƒŸãƒãƒ©ãƒ«ãƒ»ãƒ“ã‚¿ãƒŸãƒ³ç­‰ï¼‰</div>
        <button class="btn small" type="button" data-add-nutrient>ï¼‹ è¿½åŠ æ „é¤Šç´ </button>
      </div>

      <div class="nutrients" data-nutrients></div>

      <div class="note">
        è¿½åŠ æ „é¤Šç´ ã¯ã€Œé …ç›®å / æ•°å€¤ / å˜ä½ã€ã‚’è‡ªç”±ã«å¢—ã‚„ã›ã¾ã™ï¼ˆä¾‹ï¼šé‰„ 3.4 mgã€ãƒ“ã‚¿ãƒŸãƒ³D 5.1-16.0 Î¼gï¼‰ã€‚
      </div>
    </div>
  </template>

  <template id="tplNutrient">
    <div class="nutRow" data-nutrient>
      <div>
        <label>é …ç›®å</label>
        <input type="text" data-n-name placeholder="ä¾‹ï¼šé‰„ / ãƒ“ã‚¿ãƒŸãƒ³B12 / è‘‰é…¸" />
      </div>
      <div>
        <label>æ•°å€¤</label>
        <input type="text" data-n-value placeholder="ä¾‹ï¼š3.4 / 1.2-3.8" />
      </div>
      <div>
        <label>å˜ä½</label>
        <input type="text" data-n-unit placeholder="ä¾‹ï¼šmg / Î¼g" />
      </div>
      <div class="nutRemove" style="padding-bottom:2px;">
        <button class="btn danger small" type="button" data-remove-nutrient>å‰Šé™¤</button>
      </div>
    </div>
  </template>

  <script>
    const itemsEl = document.getElementById("items");
    const tplItem = document.getElementById("tplItem");
    const tplNutrient = document.getElementById("tplNutrient");
    const outEl = document.getElementById("out");
    const toastEl = document.getElementById("toast");

    const dtEl = document.getElementById("dt");
    const dtLabelEl = document.getElementById("dtLabel");

    const btnAddItem = document.getElementById("btnAddItem");
    const btnGenerate = document.getElementById("btnGenerate");
    const btnCopy = document.getElementById("btnCopy");
    const btnFillNow = document.getElementById("btnFillNow");
    const btnReset = document.getElementById("btnReset");

    function toast(msg){
      toastEl.textContent = msg;
      if (!msg) return;
      clearTimeout(toast._t);
      toast._t = setTimeout(()=> toastEl.textContent = "", 2200);
    }

    function formatDateTime(dtLocalValue){
      if(!dtLocalValue) return "";
      const [d, t] = dtLocalValue.split("T");
      const [y, m, day] = d.split("-");
      return `${y}/${m}/${day} ${t}`;
    }

    function safeNumStr(n){
      if (n === "" || n === null || n === undefined) return "";
      const x = Number(n);
      if (Number.isNaN(x)) return "";
      return String(x);
    }

    function renumberItems(){
      [...itemsEl.querySelectorAll("[data-item]")].forEach((item, idx)=>{
        const idxEl = item.querySelector("[data-item-index]");
        if (idxEl) idxEl.textContent = String(idx + 1);
        const removeBtn = item.querySelector("[data-remove-item]");
        if (removeBtn) removeBtn.style.visibility = (itemsEl.children.length <= 1) ? "hidden" : "visible";
      });
    }

    function addItem(prefill = {}){
      const node = tplItem.content.firstElementChild.cloneNode(true);

      node.querySelector("[data-name]").value = prefill.name ?? "";
      node.querySelector("[data-note]").value = prefill.note ?? "";
      node.querySelector("[data-kcal]").value = prefill.kcal ?? "";
      node.querySelector("[data-protein]").value = prefill.protein ?? "";
      node.querySelector("[data-fat]").value = prefill.fat ?? "";
      node.querySelector("[data-carb]").value = prefill.carb ?? "";
      node.querySelector("[data-sugar]").value = prefill.sugar ?? "";
      node.querySelector("[data-fiber]").value = prefill.fiber ?? "";
      node.querySelector("[data-salt]").value = prefill.salt ?? "";
      node.querySelector("[data-amountOnly]").value = prefill.amountOnly ?? "";

      node.querySelector("[data-remove-item]").addEventListener("click", ()=>{
        node.remove();
        renumberItems();
      });

      node.querySelector("[data-add-nutrient]").addEventListener("click", ()=>{
        const list = node.querySelector("[data-nutrients]");
        list.appendChild(createNutrientRow());
      });

      itemsEl.appendChild(node);
      renumberItems();
      return node;
    }

    function createNutrientRow(prefill = {}){
      const row = tplNutrient.content.firstElementChild.cloneNode(true);
      row.querySelector("[data-n-name]").value = prefill.name ?? "";
      row.querySelector("[data-n-value]").value = prefill.value ?? "";
      row.querySelector("[data-n-unit]").value = prefill.unit ?? "";

      row.querySelector("[data-remove-nutrient]").addEventListener("click", ()=>{
        row.remove();
      });
      return row;
    }

    function collectData(){
      const dt = dtEl.value;
      const dtLabel = (dtLabelEl.value || "").trim();

      const items = [...itemsEl.querySelectorAll("[data-item]")].map(item => {
        const name = item.querySelector("[data-name]").value.trim();
        const note = item.querySelector("[data-note]").value.trim();
        const amountOnly = item.querySelector("[data-amountOnly]").value.trim();

        const kcal = item.querySelector("[data-kcal]").value;
        const protein = item.querySelector("[data-protein]").value;
        const fat = item.querySelector("[data-fat]").value;
        const carb = item.querySelector("[data-carb]").value;
        const sugar = item.querySelector("[data-sugar]").value.trim();
        const fiber = item.querySelector("[data-fiber]").value.trim();
        const salt = item.querySelector("[data-salt]").value;

        const nutrients = [...item.querySelectorAll("[data-nutrient]")].map(r => ({
          name: r.querySelector("[data-n-name]").value.trim(),
          value: r.querySelector("[data-n-value]").value.trim(),
          unit: r.querySelector("[data-n-unit]").value.trim()
        })).filter(n => n.name || n.value || n.unit);

        return { name, note, amountOnly, kcal, protein, fat, carb, sugar, fiber, salt, nutrients };
      });

      return { dt, dtLabel, items };
    }

    function itemToText(it){
      const lines = [];
      const hasMajor =
        it.kcal !== "" || it.protein !== "" || it.fat !== "" || it.carb !== "" || it.salt !== "" ||
        it.sugar !== "" || it.fiber !== "";

      if (!hasMajor && it.amountOnly){
        if (it.name) lines.push(`â—${it.name} â€¦ ${it.amountOnly}`);
        else lines.push(`â—${it.amountOnly}`);
        return lines.join("\n");
      }

      const headName = it.name || "(å“åæœªå…¥åŠ›)";
      const head = it.note ? `â—${headName}${it.note}` : `â—${headName}`;
      lines.push(head);

      if (it.kcal !== "") lines.push(`ç†±é‡ : ${safeNumStr(it.kcal)}kcal`);
      if (it.protein !== "") lines.push(`ãŸã‚“ã±ãè³ª : ${safeNumStr(it.protein)}g`);
      if (it.fat !== "") lines.push(`è„‚è³ª : ${safeNumStr(it.fat)}g`);

      if (it.carb !== "" || it.sugar || it.fiber){
        const carbStr = it.carb !== "" ? `${safeNumStr(it.carb)}g` : "";
        const parts = [];
        if (it.sugar) parts.push(`ç³–è³ª : ${it.sugar}g`);
        if (it.fiber) parts.push(`é£Ÿç‰©ç¹Šç¶­ : ${it.fiber}g`);
        if (parts.length){
          if (carbStr) lines.push(`ç‚­æ°´åŒ–ç‰© : ${carbStr}(${parts.join("ã€")})`);
          else lines.push(`ç‚­æ°´åŒ–ç‰© : (${parts.join("ã€")})`);
        } else if (carbStr){
          lines.push(`ç‚­æ°´åŒ–ç‰© : ${carbStr}`);
        }
      }

      if (it.salt !== "") lines.push(`é£Ÿå¡©ç›¸å½“é‡ : ${safeNumStr(it.salt)}g`);

      for (const n of it.nutrients){
        const nName = n.name || "(é …ç›®)";
        const value = (n.value || "").trim();
        const unit = (n.unit || "").trim();
        if (!value && !unit) lines.push(`${nName} : `);
        else lines.push(`${nName} : ${value}${unit}`);
      }

      if (it.amountOnly) lines.push(`é‡ : ${it.amountOnly}`);
      return lines.join("\n");
    }

    function generateText(){
      const data = collectData();
      const blocks = [];

      const dtFormatted = formatDateTime(data.dt);
      if (dtFormatted || data.dtLabel){
        if (data.dtLabel && dtFormatted) blocks.push(`${data.dtLabel}ï¼ˆ${dtFormatted}ï¼‰`);
        else if (data.dtLabel) blocks.push(`${data.dtLabel}`);
        else blocks.push(`${dtFormatted}`);
        blocks.push("");
      }

      const itemTexts = data.items.map(itemToText).filter(t => t.trim().length > 0);
      blocks.push(itemTexts.join("\n\n"));
      return blocks.join("\n");
    }

    btnAddItem.addEventListener("click", ()=> addItem());
    btnGenerate.addEventListener("click", ()=>{
      outEl.value = generateText();
      toast("å‡ºåŠ›ã‚’æ›´æ–°ã—ã¾ã—ãŸ");
    });

    btnCopy.addEventListener("click", async ()=>{
      const text = outEl.value.trim();
      if (!text){
        toast("å…ˆã«ã€Œè¨˜éŒ²ç”¨ã«è¡¨ç¤ºã€ã‚’æŠ¼ã—ã¦å‡ºåŠ›ã—ã¦ãã ã•ã„");
        return;
      }
      try{
        await navigator.clipboard.writeText(outEl.value);
        toast("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
      }catch(e){
        outEl.focus();
        outEl.select();
        const ok = document.execCommand("copy");
        toast(ok ? "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼ˆäº’æ›ãƒ¢ãƒ¼ãƒ‰ï¼‰" : "ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ");
      }
    });

    btnFillNow.addEventListener("click", ()=>{
      const now = new Date();
      const pad = (n)=> String(n).padStart(2,"0");
      const yyyy = now.getFullYear();
      const mm = pad(now.getMonth()+1);
      const dd = pad(now.getDate());
      const hh = pad(now.getHours());
      const mi = pad(now.getMinutes());
      dtEl.value = `${yyyy}-${mm}-${dd}T${hh}:${mi}`;
      toast("ç¾åœ¨ã®æ—¥æ™‚ã‚’å…¥åŠ›ã—ã¾ã—ãŸ");
    });

    btnReset.addEventListener("click", ()=>{
      if (!confirm("å…¥åŠ›å†…å®¹ã‚’ã™ã¹ã¦æ¶ˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) return;
      dtEl.value = "";
      dtLabelEl.value = "";
      outEl.value = "";
      itemsEl.innerHTML = "";
      addItem();
      toast("å…¨æ¶ˆå»ã—ã¾ã—ãŸ");
    });

    addItem();
  </script>
</body>
</html>
